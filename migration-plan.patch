From de88c969ee43e0185923684cdc0d5323eecfadc0 Mon Sep 17 00:00:00 2001
From: Claude <noreply@anthropic.com>
Date: Wed, 12 Nov 2025 21:12:11 +0000
Subject: [PATCH 1/2] docs: Add complete monorepo migration plan
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

- 4-phase migration strategy (6-8 weeks)
- ProApp central auth hub architecture
- SQLite â†’ Supabase migration guide
- Cost analysis (5/month unified)
- Detailed code examples for each phase
- Success criteria and risk mitigation
---
 docs/MONOREPO_MIGRATION_PLAN.md | 1236 +++++++++++++++++++++++++++++++
 1 file changed, 1236 insertions(+)
 create mode 100644 docs/MONOREPO_MIGRATION_PLAN.md

diff --git a/docs/MONOREPO_MIGRATION_PLAN.md b/docs/MONOREPO_MIGRATION_PLAN.md
new file mode 100644
index 0000000..2084e54
--- /dev/null
+++ b/docs/MONOREPO_MIGRATION_PLAN.md
@@ -0,0 +1,1236 @@
+# ğŸ—ï¸ PRO-APP ECOSYSTEM - MONOREPO MIGRATION PLAN
+
+**Created:** 12. listopadu 2025
+**Author:** Claude Code + Lenka RoubalovÃ¡
+**Status:** Strategic Plan - Ready for Implementation
+
+---
+
+## ğŸ“‹ EXECUTIVE SUMMARY
+
+### Current State
+- **4 separate projects:** CoachPro, PaymentsPro, DigiPro, LifePro
+- **3 tech stacks:** React+Vite, React+Vite+Express, Next.js
+- **3 databases:** Supabase (CoachPro), SQLite (PaymentsPro), SQLite (DigiPro)
+- **Duplication:** ~85% code duplication in UI, auth, utils
+
+### Target State
+- **1 monorepo:** `pro-app` with 5 apps (ProApp + 4 modules)
+- **1 tech stack:** React + Vite + Supabase (unified)
+- **1 database:** Shared Supabase PostgreSQL
+- **Shared packages:** 73-85% code reduction via `@pro/*` packages
+
+### Benefits
+- ğŸ’° **Cost:** $0-160/month â†’ **$25/month** (savings $135/month)
+- ğŸš€ **Development:** Shared components = faster features
+- ğŸ” **Auth:** Single Sign-On (SSO) across all modules
+- ğŸ¨ **Design:** 100% consistent UI via shared design system
+- ğŸ› ï¸ **Maintenance:** Bug fix once = fixed everywhere
+
+---
+
+## ğŸ¯ FINAL ARCHITECTURE
+
+```
+pro-app/                              # Turborepo monorepo
+â”‚
+â”œâ”€â”€ apps/
+â”‚   â”‚
+â”‚   â”œâ”€â”€ proapp/                       # ğŸ° CENTRAL AUTH HUB (NEW!)
+â”‚   â”‚   â”œâ”€â”€ src/
+â”‚   â”‚   â”‚   â”œâ”€â”€ pages/
+â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Login.jsx        # Google OAuth + Email/Password
+â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.jsx    # Module switcher (cards)
+â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Subscription.jsx # Stripe checkout
+â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Admin.jsx        # User + module management
+â”‚   â”‚   â”‚   â”œâ”€â”€ components/
+â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ModuleSwitcher/  # Card grid (CoachPro, PaymentsPro, etc.)
+â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SubscriptionCard/
+â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AccessControl/   # Check module access
+â”‚   â”‚   â”‚   â””â”€â”€ App.jsx
+â”‚   â”‚   â””â”€â”€ package.json
+â”‚   â”‚
+â”‚   â”œâ”€â”€ coachpro/                     # MODULE 1 (existing)
+â”‚   â”‚   â”œâ”€â”€ src/                      # React + Vite
+â”‚   â”‚   â”‚   â”œâ”€â”€ pages/
+â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CoachDashboard/
+â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MaterialsLibrary/
+â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Programs/
+â”‚   â”‚   â”‚   â”‚   â””â”€â”€ CoachingCards/
+â”‚   â”‚   â”‚   â””â”€â”€ App.jsx
+â”‚   â”‚   â””â”€â”€ package.json
+â”‚   â”‚
+â”‚   â”œâ”€â”€ paymentspro/                  # MODULE 2 (migrate from Express)
+â”‚   â”‚   â”œâ”€â”€ src/                      # React + Vite (REMOVE backend folder!)
+â”‚   â”‚   â”‚   â”œâ”€â”€ pages/
+â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PaymentsList/
+â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Categories/
+â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Rezervy/
+â”‚   â”‚   â”‚   â””â”€â”€ App.jsx
+â”‚   â”‚   â””â”€â”€ package.json
+â”‚   â”‚
+â”‚   â”œâ”€â”€ digipro/                      # MODULE 3 (migrate from Express)
+â”‚   â”‚   â”œâ”€â”€ src/                      # React + Vite (REMOVE backend folder!)
+â”‚   â”‚   â”‚   â”œâ”€â”€ pages/
+â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Products/
+â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Customers/
+â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Funnels/
+â”‚   â”‚   â”‚   â””â”€â”€ App.jsx
+â”‚   â”‚   â””â”€â”€ package.json
+â”‚   â”‚
+â”‚   â””â”€â”€ lifepro/                      # MODULE 4 (change from Next.js)
+â”‚       â”œâ”€â”€ src/                      # React + Vite (NOT Next.js!)
+â”‚       â”‚   â”œâ”€â”€ pages/
+â”‚       â”‚   â”‚   â”œâ”€â”€ Questionnaire/
+â”‚       â”‚   â”‚   â”œâ”€â”€ Results/
+â”‚       â”‚   â”‚   â””â”€â”€ AIAnalysis/
+â”‚       â”‚   â””â”€â”€ App.jsx
+â”‚       â””â”€â”€ package.json
+â”‚
+â”œâ”€â”€ packages/                         # SHARED CODE (extract from apps)
+â”‚   â”‚
+â”‚   â”œâ”€â”€ @pro/ui/                      # â­ Design System
+â”‚   â”‚   â”œâ”€â”€ themes/
+â”‚   â”‚   â”‚   â”œâ”€â”€ nature.js            # From CoachPro
+â”‚   â”‚   â”‚   â”œâ”€â”€ unifiedColors.js     # From PaymentsPro (4 color schemes)
+â”‚   â”‚   â”‚   â””â”€â”€ index.js
+â”‚   â”‚   â”œâ”€â”€ components/
+â”‚   â”‚   â”‚   â”œâ”€â”€ UniversalDialog/     # From PaymentsPro (-63% code!)
+â”‚   â”‚   â”‚   â”œâ”€â”€ BaseCard/            # From CoachPro
+â”‚   â”‚   â”‚   â”œâ”€â”€ FloatingMenu/        # From both (merge)
+â”‚   â”‚   â”‚   â”œâ”€â”€ PhotoUpload/         # From CoachPro
+â”‚   â”‚   â”‚   â””â”€â”€ SessionCard/         # From CoachPro
+â”‚   â”‚   â”œâ”€â”€ constants/
+â”‚   â”‚   â”‚   â”œâ”€â”€ icons.js             # From CoachPro (centralized)
+â”‚   â”‚   â”‚   â””â”€â”€ borderRadius.js      # From CoachPro (5-tier)
+â”‚   â”‚   â”œâ”€â”€ styles/
+â”‚   â”‚   â”‚   â”œâ”€â”€ glassmorphism.js     # Merge both versions
+â”‚   â”‚   â”‚   â”œâ”€â”€ modernEffects.js     # From both
+â”‚   â”‚   â”‚   â””â”€â”€ animations.js        # Framer Motion
+â”‚   â”‚   â””â”€â”€ hooks/
+â”‚   â”‚       â”œâ”€â”€ useModernEffects.js  # From PaymentsPro
+â”‚   â”‚       â”œâ”€â”€ useResponsive.js     # From CoachPro
+â”‚   â”‚       â”œâ”€â”€ useAsync.js          # From CoachPro
+â”‚   â”‚       â””â”€â”€ useModal.js          # From CoachPro
+â”‚   â”‚
+â”‚   â”œâ”€â”€ @pro/auth/                    # â­ Authentication (from CoachPro)
+â”‚   â”‚   â”œâ”€â”€ GenericAuthContext.jsx   # Factory pattern (-73% code!)
+â”‚   â”‚   â”œâ”€â”€ GenericAuthGuard.jsx     # Route protection
+â”‚   â”‚   â”œâ”€â”€ GoogleSignInButton.jsx   # OAuth
+â”‚   â”‚   â”œâ”€â”€ RootRedirect.jsx         # Universal OAuth entry
+â”‚   â”‚   â””â”€â”€ useAuth.js               # Hook
+â”‚   â”‚
+â”‚   â”œâ”€â”€ @pro/database/                # â­ Supabase Utils
+â”‚   â”‚   â”œâ”€â”€ client.js                # Supabase client factory
+â”‚   â”‚   â”œâ”€â”€ sessions.js              # From CoachPro (402 lines, Czech locale)
+â”‚   â”‚   â”œâ”€â”€ photoStorage.js          # From CoachPro (upload/delete)
+â”‚   â”‚   â”œâ”€â”€ imageCompression.js      # From CoachPro (WebP)
+â”‚   â”‚   â””â”€â”€ queries/
+â”‚   â”‚       â”œâ”€â”€ payments.js          # From PaymentsPro (migrate SQL â†’ Supabase)
+â”‚   â”‚       â”œâ”€â”€ products.js          # From DigiPro
+â”‚   â”‚       â””â”€â”€ questionnaires.js    # For LifePro
+â”‚   â”‚
+â”‚   â”œâ”€â”€ @pro/integrations/            # External APIs (from DigiPro)
+â”‚   â”‚   â”œâ”€â”€ email/
+â”‚   â”‚   â”‚   â”œâ”€â”€ smartemailing.js
+â”‚   â”‚   â”‚   â”œâ”€â”€ mailchimp.js
+â”‚   â”‚   â”‚   â””â”€â”€ mailerlite.js
+â”‚   â”‚   â”œâ”€â”€ payments/
+â”‚   â”‚   â”‚   â””â”€â”€ stripe.js            # From PaymentsPro + ProApp subscriptions
+â”‚   â”‚   â”œâ”€â”€ courses/
+â”‚   â”‚   â”‚   â””â”€â”€ kajabi.js
+â”‚   â”‚   â””â”€â”€ ai/
+â”‚   â”‚       â””â”€â”€ claude.js            # For LifePro AI analysis
+â”‚   â”‚
+â”‚   â”œâ”€â”€ @pro/notifications/           # Toast + Email
+â”‚   â”‚   â”œâ”€â”€ NotificationContext.jsx  # From CoachPro (toast)
+â”‚   â”‚   â””â”€â”€ email-templates/         # Shared templates
+â”‚   â”‚
+â”‚   â””â”€â”€ @pro/utils/                   # Helpers
+â”‚       â”œâ”€â”€ czechGrammar.js          # From CoachPro (vocative case)
+â”‚       â”œâ”€â”€ banking.js               # SPAYD QR codes (from PaymentsPro)
+â”‚       â”œâ”€â”€ date.js                  # Czech locale (date-fns)
+â”‚       â””â”€â”€ validation.js            # Zod schemas
+â”‚
+â”œâ”€â”€ supabase/                         # â­ SINGLE SHARED SUPABASE
+â”‚   â”œâ”€â”€ config.toml
+â”‚   â”œâ”€â”€ migrations/
+â”‚   â”‚   â”œâ”€â”€ 001_auth_core.sql       # ProApp auth tables
+â”‚   â”‚   â”œâ”€â”€ 002_coachpro.sql        # CoachPro tables (existing)
+â”‚   â”‚   â”œâ”€â”€ 003_paymentspro.sql     # PaymentsPro (migrate from SQLite)
+â”‚   â”‚   â”œâ”€â”€ 004_digipro.sql         # DigiPro (migrate from SQLite)
+â”‚   â”‚   â””â”€â”€ 005_lifepro.sql         # LifePro tables
+â”‚   â”œâ”€â”€ functions/                   # Edge Functions (serverless!)
+â”‚   â”‚   â”œâ”€â”€ claude-analysis/        # LifePro AI (Claude API)
+â”‚   â”‚   â”œâ”€â”€ pdf-export/             # LifePro PDF generation
+â”‚   â”‚   â””â”€â”€ stripe-webhook/         # ProApp subscription webhooks
+â”‚   â””â”€â”€ seed/
+â”‚       â”œâ”€â”€ test_users.sql
+â”‚       â””â”€â”€ demo_data.sql
+â”‚
+â”œâ”€â”€ scripts/                          # Migration scripts
+â”‚   â”œâ”€â”€ migrate-paymentspro-sqlite.js
+â”‚   â”œâ”€â”€ migrate-digipro-sqlite.js
+â”‚   â””â”€â”€ setup-monorepo.sh
+â”‚
+â”œâ”€â”€ .github/
+â”‚   â””â”€â”€ workflows/
+â”‚       â”œâ”€â”€ deploy-proapp.yml
+â”‚       â”œâ”€â”€ deploy-coachpro.yml
+â”‚       â”œâ”€â”€ deploy-paymentspro.yml
+â”‚       â”œâ”€â”€ deploy-digipro.yml
+â”‚       â”œâ”€â”€ deploy-lifepro.yml
+â”‚       â””â”€â”€ test.yml
+â”‚
+â”œâ”€â”€ docs/
+â”‚   â”œâ”€â”€ ARCHITECTURE.md
+â”‚   â”œâ”€â”€ MONOREPO_MIGRATION_PLAN.md  # This file!
+â”‚   â””â”€â”€ modules/
+â”‚       â”œâ”€â”€ proapp/
+â”‚       â”œâ”€â”€ coachpro/
+â”‚       â”œâ”€â”€ paymentspro/
+â”‚       â”œâ”€â”€ digipro/
+â”‚       â””â”€â”€ lifepro/
+â”‚
+â”œâ”€â”€ package.json                      # Root package.json (Turborepo)
+â”œâ”€â”€ turbo.json                        # Turborepo config
+â”œâ”€â”€ pnpm-workspace.yaml               # PNPM workspaces
+â””â”€â”€ README.md
+```
+
+---
+
+## ğŸ—„ï¸ DATABASE SCHEMA (Supabase)
+
+### **Core Auth Tables (ProApp)**
+
+```sql
+-- Users (central auth)
+CREATE TABLE users (
+  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
+  email text UNIQUE NOT NULL,
+  auth_provider text, -- 'google', 'apple', 'email'
+  full_name text,
+  photo_url text,
+  created_at timestamptz DEFAULT now(),
+  updated_at timestamptz DEFAULT now()
+);
+
+-- Subscriptions
+CREATE TABLE subscriptions (
+  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
+  user_id uuid REFERENCES users(id) ON DELETE CASCADE,
+  plan text NOT NULL, -- 'free', 'basic', 'premium', 'business'
+  status text NOT NULL, -- 'active', 'trial', 'cancelled', 'expired'
+  trial_ends_at timestamptz,
+  current_period_start timestamptz,
+  current_period_end timestamptz,
+  stripe_customer_id text,
+  stripe_subscription_id text,
+  created_at timestamptz DEFAULT now()
+);
+
+-- Module Access Control
+CREATE TABLE module_access (
+  user_id uuid REFERENCES users(id) ON DELETE CASCADE,
+  module_name text NOT NULL, -- 'coachpro', 'paymentspro', 'digipro', 'lifepro'
+  has_access boolean DEFAULT false,
+  granted_at timestamptz DEFAULT now(),
+  PRIMARY KEY (user_id, module_name)
+);
+
+-- RLS Policies
+ALTER TABLE users ENABLE ROW LEVEL SECURITY;
+ALTER TABLE subscriptions ENABLE ROW LEVEL SECURITY;
+ALTER TABLE module_access ENABLE ROW LEVEL SECURITY;
+
+-- Users can view/edit own data
+CREATE POLICY "Users view own data" ON users
+  FOR SELECT USING (auth.uid() = id);
+
+CREATE POLICY "Users edit own data" ON users
+  FOR UPDATE USING (auth.uid() = id);
+
+-- Module access policy (example for CoachPro)
+CREATE POLICY "Users with CoachPro access" ON coachpro_materials
+  FOR SELECT USING (
+    EXISTS (
+      SELECT 1 FROM module_access
+      WHERE user_id = auth.uid()
+      AND module_name = 'coachpro'
+      AND has_access = true
+    )
+  );
+```
+
+### **Module Tables**
+
+Each module keeps its existing tables with added RLS:
+- **CoachPro:** `coachpro_*` (already exists)
+- **PaymentsPro:** `paymentspro_*` (migrate from SQLite)
+- **DigiPro:** `digipro_*` (migrate from SQLite)
+- **LifePro:** `lifepro_*` (new)
+
+---
+
+## ğŸ’° COST ANALYSIS
+
+### **Current (Separate Apps)**
+
+| Item | Cost/Month |
+|------|-----------|
+| CoachPro (Supabase Free) | $0 |
+| CoachPro (Vercel) | $0 |
+| PaymentsPro (Local + SQLite) | $0 (not deployed) |
+| DigiPro (Local + SQLite) | $0 (not deployed) |
+| LifePro (TBD) | $0 (not started) |
+| **TOTAL** | **$0** (but not production-ready) |
+
+**For Production (separate):**
+| Item | Cost/Month |
+|------|-----------|
+| Supabase (4 separate projects Ã— $25) | $100 |
+| Vercel (4 apps on Hobby) | $0 |
+| OR Railway (3 backends Ã— $5) | $15 |
+| **TOTAL** | **$100-115/month** |
+
+---
+
+### **Monorepo (Unified)**
+
+| Item | Cost/Month | Notes |
+|------|-----------|-------|
+| **Supabase Pro** (1 shared project) | **$25** | 8GB DB, 100GB storage, all 5 apps |
+| Vercel Hobby (5 frontends) | $0 | ProApp + 4 modules |
+| Stripe | 2.9% + 30Â¢ | Per transaction only |
+| **TOTAL** | **$25/month** | ğŸ‰ |
+
+**Savings:** $75-90/month ($900-1080/year)
+
+---
+
+## ğŸš€ 4-PHASE MIGRATION PLAN
+
+### **PHASE 1: Setup Monorepo Foundation** (Week 1)
+
+**Duration:** 5-7 days
+**Goal:** Create monorepo structure + shared Supabase
+
+#### Tasks:
+
+**1.1 Create Monorepo** (Day 1)
+```bash
+# On your local machine
+mkdir pro-app
+cd pro-app
+
+# Initialize PNPM workspace
+pnpm init
+echo 'packages:\n  - "apps/*"\n  - "packages/*"' > pnpm-workspace.yaml
+
+# Install Turborepo
+pnpm add -D turbo
+
+# Create folder structure
+mkdir -p apps/proapp apps/coachpro apps/paymentspro apps/digipro apps/lifepro
+mkdir -p packages/@pro/ui packages/@pro/auth packages/@pro/database
+mkdir -p packages/@pro/integrations packages/@pro/notifications packages/@pro/utils
+mkdir -p supabase/migrations supabase/functions
+mkdir -p scripts docs
+```
+
+**1.2 Setup Supabase Project** (Day 1)
+```bash
+# Create new Supabase project at supabase.com
+# Project name: pro-app-ecosystem
+# Region: Central EU (Frankfurt)
+# Plan: Free (upgrade to Pro later)
+
+# Get credentials
+SUPABASE_URL=https://xxxxx.supabase.co
+SUPABASE_ANON_KEY=eyJxxx...
+SUPABASE_SERVICE_ROLE_KEY=eyJxxx...
+
+# Install Supabase CLI
+pnpm add -D supabase
+
+# Link project
+supabase link --project-ref xxxxx
+```
+
+**1.3 Run Core Auth Migration** (Day 2)
+```bash
+# Create and run first migration
+supabase migration new auth_core
+
+# Copy SQL from section above (users, subscriptions, module_access)
+# Then apply
+supabase db push
+```
+
+**1.4 Extract Shared Packages** (Days 3-5)
+
+**From CoachPro:**
+- Copy `src/shared/context/GenericAuthContext.jsx` â†’ `packages/@pro/auth/`
+- Copy `src/shared/components/BaseCard.jsx` â†’ `packages/@pro/ui/components/`
+- Copy `src/shared/utils/sessions.js` â†’ `packages/@pro/database/`
+- Copy `src/shared/utils/photoStorage.js` â†’ `packages/@pro/database/`
+- Copy `src/shared/utils/imageCompression.js` â†’ `packages/@pro/database/`
+- Copy `src/shared/constants/icons.js` â†’ `packages/@pro/ui/constants/`
+- Copy `src/styles/borderRadius.js` â†’ `packages/@pro/ui/constants/`
+- Copy `src/shared/styles/modernEffects.js` â†’ `packages/@pro/ui/styles/`
+
+**From PaymentsPro:**
+- Copy `UniversalDialog` â†’ `packages/@pro/ui/components/`
+- Copy `UnifiedColorContext` â†’ `packages/@pro/ui/themes/`
+- Copy `useModernEffects` hook â†’ `packages/@pro/ui/hooks/`
+
+**From DigiPro:**
+- Copy `integrations/` folder â†’ `packages/@pro/integrations/`
+
+**1.5 Setup Turborepo Config** (Day 5)
+```json
+// turbo.json
+{
+  "pipeline": {
+    "build": {
+      "dependsOn": ["^build"],
+      "outputs": ["dist/**", ".next/**"]
+    },
+    "dev": {
+      "cache": false
+    },
+    "lint": {},
+    "test": {}
+  }
+}
+```
+
+**Deliverables:**
+- âœ… Monorepo structure created
+- âœ… Supabase project setup
+- âœ… Core auth tables migrated
+- âœ… Shared packages extracted
+- âœ… Turborepo configured
+
+---
+
+### **PHASE 2: Create ProApp (Central Auth Hub)** (Week 2)
+
+**Duration:** 5-7 days
+**Goal:** Build central auth + module switcher
+
+#### Tasks:
+
+**2.1 ProApp Frontend Setup** (Day 1)
+```bash
+cd apps/proapp
+pnpm create vite . --template react
+pnpm add @mui/material @emotion/react @emotion/styled
+pnpm add react-router-dom @supabase/supabase-js
+pnpm add @pro/ui @pro/auth @pro/database
+```
+
+**2.2 Auth Pages** (Days 2-3)
+
+**Login.jsx:**
+```jsx
+import { GoogleSignInButton } from '@pro/auth';
+import { supabase } from '@pro/database';
+
+export default function Login() {
+  const handleEmailLogin = async (email, password) => {
+    const { data, error } = await supabase.auth.signInWithPassword({
+      email,
+      password
+    });
+    // Redirect to /dashboard
+  };
+
+  return (
+    <Box>
+      <Typography variant="h4">Welcome to Pro App</Typography>
+
+      {/* Email/Password form */}
+      <TextField label="Email" />
+      <TextField label="Password" type="password" />
+      <Button onClick={handleEmailLogin}>Sign In</Button>
+
+      {/* Google OAuth */}
+      <GoogleSignInButton redirectTo="/dashboard" />
+
+      <Link to="/register">Create Account</Link>
+    </Box>
+  );
+}
+```
+
+**Register.jsx:**
+```jsx
+const handleRegister = async (email, password, fullName) => {
+  // 1. Create auth user
+  const { data: authData, error } = await supabase.auth.signUp({
+    email,
+    password,
+    options: {
+      data: { full_name: fullName }
+    }
+  });
+
+  // 2. Create user record
+  await supabase.from('users').insert({
+    id: authData.user.id,
+    email,
+    full_name: fullName,
+    auth_provider: 'email'
+  });
+
+  // 3. Grant free tier access to all modules
+  const modules = ['coachpro', 'paymentspro', 'digipro', 'lifepro'];
+  await supabase.from('module_access').insert(
+    modules.map(module => ({
+      user_id: authData.user.id,
+      module_name: module,
+      has_access: true // Free tier = all access for now
+    }))
+  );
+
+  // Redirect to /dashboard
+};
+```
+
+**2.3 Dashboard (Module Switcher)** (Days 4-5)
+```jsx
+import { useAuth } from '@pro/auth';
+import { BaseCard } from '@pro/ui';
+
+export default function Dashboard() {
+  const { user } = useAuth();
+  const [modules, setModules] = useState([]);
+
+  useEffect(() => {
+    // Fetch user's module access
+    const fetchModules = async () => {
+      const { data } = await supabase
+        .from('module_access')
+        .select('module_name, has_access')
+        .eq('user_id', user.id);
+      setModules(data);
+    };
+    fetchModules();
+  }, [user]);
+
+  const moduleCards = [
+    {
+      name: 'coachpro',
+      title: 'CoachPro',
+      description: 'Coaching materials & programs',
+      icon: 'ğŸŒ¿',
+      url: 'https://coachpro-weld.vercel.app'
+    },
+    {
+      name: 'paymentspro',
+      title: 'PaymentsPro',
+      description: 'Invoice management',
+      icon: 'ğŸ’°',
+      url: 'https://paymentspro.vercel.app'
+    },
+    // ... etc
+  ];
+
+  return (
+    <Container>
+      <Typography variant="h4">Your Modules</Typography>
+      <Grid container spacing={3}>
+        {moduleCards.map(module => {
+          const access = modules.find(m => m.module_name === module.name);
+          return (
+            <Grid item xs={12} sm={6} md={4} key={module.name}>
+              <BaseCard
+                title={module.title}
+                description={module.description}
+                icon={module.icon}
+                locked={!access?.has_access}
+                onClick={() => {
+                  if (access?.has_access) {
+                    window.location.href = module.url;
+                  } else {
+                    navigate('/subscription');
+                  }
+                }}
+              />
+            </Grid>
+          );
+        })}
+      </Grid>
+    </Container>
+  );
+}
+```
+
+**2.4 Subscription Page** (Days 6-7)
+```jsx
+import { loadStripe } from '@stripe/stripe-js';
+
+export default function Subscription() {
+  const plans = [
+    { name: 'Free', price: 0, modules: ['coachpro'] },
+    { name: 'Basic', price: 9, modules: ['coachpro', 'paymentspro'] },
+    { name: 'Premium', price: 29, modules: ['coachpro', 'paymentspro', 'digipro', 'lifepro'] },
+  ];
+
+  const handleCheckout = async (plan) => {
+    // Call Stripe Checkout
+    const stripe = await loadStripe(STRIPE_PUBLIC_KEY);
+    const { data } = await supabase.functions.invoke('stripe-checkout', {
+      body: { planName: plan.name }
+    });
+    await stripe.redirectToCheckout({ sessionId: data.sessionId });
+  };
+
+  return (
+    <Grid container spacing={3}>
+      {plans.map(plan => (
+        <Grid item xs={12} md={4} key={plan.name}>
+          <Card>
+            <CardContent>
+              <Typography variant="h5">{plan.name}</Typography>
+              <Typography variant="h3">${plan.price}/mo</Typography>
+              <Button onClick={() => handleCheckout(plan)}>
+                Subscribe
+              </Button>
+            </CardContent>
+          </Card>
+        </Grid>
+      ))}
+    </Grid>
+  );
+}
+```
+
+**2.5 Deploy ProApp** (Day 7)
+```bash
+# Connect to Vercel
+vercel
+
+# Set env vars in Vercel dashboard
+VITE_SUPABASE_URL=...
+VITE_SUPABASE_ANON_KEY=...
+
+# Deploy
+vercel --prod
+```
+
+**Deliverables:**
+- âœ… ProApp deployed at `https://proapp.vercel.app`
+- âœ… Google OAuth + Email login working
+- âœ… Module switcher dashboard working
+- âœ… Subscription page created (Stripe TBD)
+
+---
+
+### **PHASE 3: Migrate PaymentsPro & DigiPro** (Weeks 3-4)
+
+**Duration:** 10-14 days
+**Goal:** Migrate SQLite â†’ Supabase, remove Express backends
+
+#### **3.1 PaymentsPro Migration** (Days 1-7)
+
+**Step 1: Export SQLite Data** (Day 1)
+```bash
+cd ~/my-paymentspro-app/backend
+node scripts/export-sqlite.js
+# Outputs: paymentspro_export.json
+```
+
+**Step 2: Create Supabase Schema** (Day 2)
+```sql
+-- supabase/migrations/003_paymentspro.sql
+CREATE TABLE paymentspro_payments (
+  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
+  user_id uuid REFERENCES users(id) ON DELETE CASCADE,
+  amount numeric NOT NULL,
+  description text,
+  payment_date date NOT NULL,
+  category_id uuid REFERENCES paymentspro_categories(id),
+  is_paid boolean DEFAULT false,
+  -- ... all 49 columns from SQLite
+  created_at timestamptz DEFAULT now()
+);
+
+CREATE TABLE paymentspro_categories (...);
+CREATE TABLE paymentspro_rezervy (...);
+-- ... etc
+
+-- RLS Policies
+ALTER TABLE paymentspro_payments ENABLE ROW LEVEL SECURITY;
+
+CREATE POLICY "Users view own payments" ON paymentspro_payments
+  FOR SELECT USING (
+    user_id = auth.uid() AND
+    EXISTS (
+      SELECT 1 FROM module_access
+      WHERE user_id = auth.uid()
+      AND module_name = 'paymentspro'
+      AND has_access = true
+    )
+  );
+
+-- Apply migration
+-- supabase db push
+```
+
+**Step 3: Import Data to Supabase** (Day 3)
+```javascript
+// scripts/import-paymentspro.js
+import { createClient } from '@supabase/supabase-js';
+import fs from 'fs';
+
+const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY);
+const data = JSON.parse(fs.readFileSync('paymentspro_export.json'));
+
+// Import payments
+for (const payment of data.payments) {
+  await supabase.from('paymentspro_payments').insert({
+    ...payment,
+    id: undefined, // Generate new UUID
+    user_id: YOUR_USER_ID // Map to new user system
+  });
+}
+
+console.log('Import complete!');
+```
+
+**Step 4: Refactor Frontend** (Days 4-6)
+
+**Before (Express API calls):**
+```javascript
+// Old PaymentsPro
+const response = await axios.get('http://localhost:4000/api/payments');
+const payments = response.data;
+```
+
+**After (Direct Supabase):**
+```javascript
+// New PaymentsPro
+import { supabase } from '@pro/database';
+
+const { data: payments } = await supabase
+  .from('paymentspro_payments')
+  .select('*')
+  .eq('user_id', user.id)
+  .order('payment_date', { ascending: false });
+```
+
+**Replace ALL axios calls:**
+- `/api/payments` â†’ `supabase.from('paymentspro_payments')`
+- `/api/categories` â†’ `supabase.from('paymentspro_categories')`
+- `/api/rezervy` â†’ `supabase.from('paymentspro_rezervy')`
+
+**Step 5: Update Imports to Use Shared Packages** (Day 6)
+```javascript
+// Replace local components with @pro packages
+import { UniversalDialog } from '@pro/ui';
+import { useAuth } from '@pro/auth';
+import { supabase } from '@pro/database';
+```
+
+**Step 6: Test & Deploy** (Day 7)
+```bash
+cd apps/paymentspro
+pnpm install
+pnpm dev # Test locally
+pnpm build
+vercel --prod # Deploy
+```
+
+---
+
+#### **3.2 DigiPro Migration** (Days 8-14)
+
+**Same process as PaymentsPro:**
+1. Export SQLite data
+2. Create Supabase schema (`004_digipro.sql`)
+3. Import data
+4. Refactor frontend (remove axios, use Supabase)
+5. Update imports to `@pro/*` packages
+6. Test & deploy
+
+**Key tables:**
+- `digipro_products`
+- `digipro_customers`
+- `digipro_funnels`
+- `digipro_integrations`
+
+**Deliverables:**
+- âœ… PaymentsPro frontend â†’ Supabase (backend removed!)
+- âœ… DigiPro frontend â†’ Supabase (backend removed!)
+- âœ… All data migrated successfully
+- âœ… Both apps deployed on Vercel
+
+---
+
+### **PHASE 4: Finalize CoachPro & Create LifePro** (Week 5-6)
+
+**Duration:** 10-14 days
+**Goal:** Integrate CoachPro into monorepo, build LifePro from scratch
+
+#### **4.1 CoachPro Integration** (Days 1-3)
+
+**Step 1: Move CoachPro to Monorepo** (Day 1)
+```bash
+# Copy CoachPro to monorepo
+cp -r ~/coachpro/src ~/pro-app/apps/coachpro/
+cp ~/coachpro/package.json ~/pro-app/apps/coachpro/
+
+cd ~/pro-app/apps/coachpro
+pnpm install
+```
+
+**Step 2: Update Imports** (Day 2)
+```javascript
+// Replace local shared code with @pro packages
+// Before:
+import { GenericAuthContext } from '../shared/context/GenericAuthContext';
+import { BaseCard } from '../shared/components/cards/BaseCard';
+
+// After:
+import { GenericAuthContext } from '@pro/auth';
+import { BaseCard } from '@pro/ui';
+```
+
+**Step 3: Add ProApp Integration** (Day 3)
+```javascript
+// In CoachPro App.jsx, check module access
+import { useAuth } from '@pro/auth';
+
+function App() {
+  const { user } = useAuth();
+  const [hasAccess, setHasAccess] = useState(false);
+
+  useEffect(() => {
+    const checkAccess = async () => {
+      const { data } = await supabase
+        .from('module_access')
+        .select('has_access')
+        .eq('user_id', user.id)
+        .eq('module_name', 'coachpro')
+        .single();
+
+      if (!data?.has_access) {
+        window.location.href = 'https://proapp.vercel.app/subscription';
+      }
+      setHasAccess(true);
+    };
+    checkAccess();
+  }, [user]);
+
+  if (!hasAccess) return <LoadingScreen />;
+  return <Router>...</Router>;
+}
+```
+
+---
+
+#### **4.2 LifePro Creation** (Days 4-14)
+
+**Step 1: Setup Frontend** (Day 4)
+```bash
+cd apps/lifepro
+pnpm create vite . --template react
+pnpm add @mui/material @emotion/react @emotion/styled
+pnpm add @pro/ui @pro/auth @pro/database
+```
+
+**Step 2: Create Supabase Schema** (Day 5)
+```sql
+-- supabase/migrations/005_lifepro.sql
+CREATE TABLE lifepro_categories (
+  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
+  name text NOT NULL,
+  description text,
+  icon text,
+  order_index int
+);
+
+CREATE TABLE lifepro_sections (
+  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
+  category_id uuid REFERENCES lifepro_categories(id),
+  title text NOT NULL,
+  description text,
+  order_index int
+);
+
+CREATE TABLE lifepro_questions (
+  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
+  section_id uuid REFERENCES lifepro_sections(id),
+  question_text text NOT NULL,
+  question_type text NOT NULL, -- 'text', 'textarea', 'radio', 'checkbox', 'slider', 'rating', 'date'
+  options jsonb, -- For radio/checkbox/select
+  order_index int
+);
+
+CREATE TABLE lifepro_user_responses (
+  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
+  user_id uuid REFERENCES users(id) ON DELETE CASCADE,
+  question_id uuid REFERENCES lifepro_questions(id),
+  response_value jsonb NOT NULL,
+  created_at timestamptz DEFAULT now(),
+  updated_at timestamptz DEFAULT now()
+);
+
+CREATE TABLE lifepro_analyses (
+  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
+  user_id uuid REFERENCES users(id) ON DELETE CASCADE,
+  analysis_text text NOT NULL, -- Claude API output
+  patterns jsonb,
+  values jsonb,
+  blind_spots jsonb,
+  created_at timestamptz DEFAULT now()
+);
+
+-- RLS Policies
+ALTER TABLE lifepro_user_responses ENABLE ROW LEVEL SECURITY;
+ALTER TABLE lifepro_analyses ENABLE ROW LEVEL SECURITY;
+
+CREATE POLICY "Users view own responses" ON lifepro_user_responses
+  FOR ALL USING (user_id = auth.uid());
+
+CREATE POLICY "Users view own analyses" ON lifepro_analyses
+  FOR ALL USING (user_id = auth.uid());
+```
+
+**Step 3: Build Questionnaire UI** (Days 6-10)
+
+```jsx
+// pages/Questionnaire.jsx
+import { useState, useEffect } from 'react';
+import { supabase } from '@pro/database';
+import { BaseCard } from '@pro/ui';
+
+export default function Questionnaire() {
+  const [categories, setCategories] = useState([]);
+  const [selectedCategory, setSelectedCategory] = useState(null);
+  const [questions, setQuestions] = useState([]);
+  const [responses, setResponses] = useState({});
+
+  useEffect(() => {
+    // Load categories
+    const fetchCategories = async () => {
+      const { data } = await supabase
+        .from('lifepro_categories')
+        .select('*')
+        .order('order_index');
+      setCategories(data);
+    };
+    fetchCategories();
+  }, []);
+
+  const loadQuestions = async (categoryId) => {
+    const { data } = await supabase
+      .from('lifepro_questions')
+      .select('*, section:lifepro_sections(*)')
+      .eq('section.category_id', categoryId)
+      .order('order_index');
+    setQuestions(data);
+  };
+
+  const saveResponse = async (questionId, value) => {
+    await supabase.from('lifepro_user_responses').upsert({
+      user_id: user.id,
+      question_id: questionId,
+      response_value: value
+    });
+    setResponses({ ...responses, [questionId]: value });
+  };
+
+  return (
+    <Container>
+      <Typography variant="h4">Life Purpose Discovery</Typography>
+
+      {/* Category selector */}
+      <Grid container spacing={2}>
+        {categories.map(cat => (
+          <Grid item xs={12} sm={6} md={4} key={cat.id}>
+            <BaseCard
+              title={cat.name}
+              icon={cat.icon}
+              onClick={() => {
+                setSelectedCategory(cat);
+                loadQuestions(cat.id);
+              }}
+            />
+          </Grid>
+        ))}
+      </Grid>
+
+      {/* Questions */}
+      {selectedCategory && (
+        <Box mt={4}>
+          {questions.map(q => (
+            <QuestionRenderer
+              key={q.id}
+              question={q}
+              value={responses[q.id]}
+              onChange={(value) => saveResponse(q.id, value)}
+            />
+          ))}
+        </Box>
+      )}
+
+      <Button onClick={generateAnalysis}>Generate AI Analysis</Button>
+    </Container>
+  );
+}
+```
+
+**Step 4: Create Edge Function for AI Analysis** (Days 11-12)
+
+```typescript
+// supabase/functions/claude-analysis/index.ts
+import { serve } from 'https://deno.land/std@0.168.0/http/server.ts';
+import Anthropic from '@anthropic-ai/sdk';
+
+serve(async (req) => {
+  const { userId } = await req.json();
+
+  // 1. Fetch user responses
+  const { data: responses } = await supabase
+    .from('lifepro_user_responses')
+    .select('*, question:lifepro_questions(*)')
+    .eq('user_id', userId);
+
+  // 2. Format for Claude
+  const prompt = `
+Analyze these life purpose questionnaire responses:
+
+${responses.map(r => `Q: ${r.question.question_text}\nA: ${r.response_value}`).join('\n\n')}
+
+Identify:
+1. Core patterns in their responses
+2. Top 3 values
+3. Potential blind spots
+4. Career direction suggestions
+`;
+
+  // 3. Call Claude API
+  const anthropic = new Anthropic({
+    apiKey: Deno.env.get('ANTHROPIC_API_KEY')
+  });
+
+  const message = await anthropic.messages.create({
+    model: 'claude-3-5-sonnet-20241022',
+    max_tokens: 2000,
+    messages: [{ role: 'user', content: prompt }]
+  });
+
+  const analysisText = message.content[0].text;
+
+  // 4. Save analysis
+  await supabase.from('lifepro_analyses').insert({
+    user_id: userId,
+    analysis_text: analysisText,
+    created_at: new Date().toISOString()
+  });
+
+  return new Response(JSON.stringify({ analysis: analysisText }), {
+    headers: { 'Content-Type': 'application/json' }
+  });
+});
+```
+
+**Step 5: Deploy Edge Function** (Day 12)
+```bash
+supabase functions deploy claude-analysis
+supabase secrets set ANTHROPIC_API_KEY=sk-xxx
+```
+
+**Step 6: Build Results Page** (Day 13)
+```jsx
+// pages/Results.jsx
+export default function Results() {
+  const [analysis, setAnalysis] = useState(null);
+
+  useEffect(() => {
+    const fetchAnalysis = async () => {
+      const { data } = await supabase
+        .from('lifepro_analyses')
+        .select('*')
+        .eq('user_id', user.id)
+        .order('created_at', { ascending: false })
+        .limit(1)
+        .single();
+      setAnalysis(data);
+    };
+    fetchAnalysis();
+  }, []);
+
+  return (
+    <Container>
+      <Typography variant="h4">Your Life Purpose Analysis</Typography>
+
+      {analysis && (
+        <Card>
+          <CardContent>
+            <Typography variant="body1" sx={{ whiteSpace: 'pre-wrap' }}>
+              {analysis.analysis_text}
+            </Typography>
+          </CardContent>
+        </Card>
+      )}
+
+      <Button onClick={exportPDF}>Export to PDF</Button>
+    </Container>
+  );
+}
+```
+
+**Step 7: Test & Deploy** (Day 14)
+```bash
+cd apps/lifepro
+pnpm dev # Test locally
+pnpm build
+vercel --prod
+```
+
+**Deliverables:**
+- âœ… CoachPro integrated into monorepo
+- âœ… LifePro fully built (questionnaire + AI analysis)
+- âœ… Edge Functions working (Claude API)
+- âœ… All 5 apps deployed
+
+---
+
+## ğŸ“… TIMELINE SUMMARY
+
+| Phase | Tasks | Duration | Cumulative |
+|-------|-------|----------|------------|
+| **Phase 1** | Setup monorepo + Supabase | 5-7 days | Week 1 |
+| **Phase 2** | Build ProApp (auth hub) | 5-7 days | Week 2 |
+| **Phase 3** | Migrate PaymentsPro + DigiPro | 10-14 days | Weeks 3-4 |
+| **Phase 4** | Integrate CoachPro + Build LifePro | 10-14 days | Weeks 5-6 |
+| **TOTAL** | **Complete migration** | **30-42 days** | **6-8 weeks** |
+
+---
+
+## âœ… SUCCESS CRITERIA
+
+### **Phase 1 Complete When:**
+- [ ] Monorepo folder structure created
+- [ ] Supabase project setup with core auth tables
+- [ ] Shared packages extracted (`@pro/ui`, `@pro/auth`, etc.)
+- [ ] Turborepo running (`turbo dev` works)
+
+### **Phase 2 Complete When:**
+- [ ] ProApp deployed at production URL
+- [ ] Google OAuth login working
+- [ ] Email/password login working
+- [ ] Module switcher dashboard showing 4 module cards
+- [ ] Subscription page created (even if Stripe not integrated yet)
+
+### **Phase 3 Complete When:**
+- [ ] PaymentsPro: All SQLite data migrated to Supabase
+- [ ] PaymentsPro: Frontend using Supabase (no Express backend!)
+- [ ] PaymentsPro: Deployed and accessible via ProApp
+- [ ] DigiPro: All SQLite data migrated to Supabase
+- [ ] DigiPro: Frontend using Supabase (no Express backend!)
+- [ ] DigiPro: Deployed and accessible via ProApp
+
+### **Phase 4 Complete When:**
+- [ ] CoachPro: Moved to monorepo and using `@pro/*` packages
+- [ ] CoachPro: Module access check integrated
+- [ ] LifePro: Frontend built with questionnaire UI
+- [ ] LifePro: Edge Function for Claude AI working
+- [ ] LifePro: Deployed and accessible via ProApp
+
+### **FINAL Success:**
+- [ ] All 5 apps (ProApp + 4 modules) deployed on Vercel
+- [ ] Single Supabase project with all tables
+- [ ] SSO working (login once â†’ access all modules)
+- [ ] Module access control working (based on subscription)
+- [ ] Cost: $25/month (Supabase Pro only)
+
+---
+
+## ğŸš¨ RISKS & MITIGATION
+
+| Risk | Impact | Mitigation |
+|------|--------|-----------|
+| **SQLite data loss during migration** | HIGH | - Backup SQLite files BEFORE export<br>- Test import on development Supabase first<br>- Verify row counts match |
+| **Vercel 10s timeout for complex queries** | MEDIUM | - Optimize Supabase queries (indexes)<br>- Use Supabase RLS (server-side filtering)<br>- Monitor query performance |
+| **Breaking changes in shared packages** | MEDIUM | - Version shared packages (`@pro/ui@1.0.0`)<br>- Use semantic versioning<br>- Test all apps before deploying |
+| **Supabase $25/month not enough** | LOW | - Monitor usage in dashboard<br>- Free tier = 500MB DB, Pro = 8GB<br>- Upgrade to Team ($599/mo) only if needed |
+| **Module access bugs (wrong permissions)** | MEDIUM | - Write RLS tests<br>- Manual testing per module<br>- Admin override for debugging |
+
+---
+
+## ğŸ“š DOCUMENTATION TO CREATE
+
+During migration, create these docs:
+
+1. **ARCHITECTURE.md** - System overview, tech stack, folder structure
+2. **AUTH.md** - How SSO works, RLS policies, adding new modules
+3. **DEPLOYMENT.md** - How to deploy each app, env vars, CI/CD
+4. **DEVELOPMENT.md** - Local setup, running all apps, debugging
+5. **SHARED_PACKAGES.md** - How to use `@pro/*` packages, adding new ones
+6. **DATABASE.md** - Schema design, migrations, RLS policies
+7. **TROUBLESHOOTING.md** - Common issues, solutions
+
+---
+
+## ğŸ¯ RECOMMENDATIONS
+
+### **Start with Phase 1 immediately:**
+1. Create GitHub repo `pro-app`
+2. Setup monorepo structure locally
+3. Create Supabase project
+4. Extract shared packages from CoachPro
+
+### **Quick Wins (Week 1):**
+- Extract `GenericAuthContext` â†’ saves 73% auth code
+- Extract `UniversalDialog` â†’ saves 63% dialog code
+- Extract `UnifiedColorContext` â†’ saves 85% color duplication
+
+### **Don't overthink:**
+- Start with basic ProApp (just login + module cards)
+- Add Stripe subscriptions LATER (free tier for now)
+- Migrate PaymentsPro first (simpler than DigiPro)
+
+### **Test incrementally:**
+- Don't wait for "perfect" - deploy often
+- Use Vercel preview deployments for testing
+- Keep old apps running until new ones proven
+
+---
+
+## ğŸ“ NEXT STEPS
+
+**Ready to start?**
+
+1. **Create GitHub repo:** `github.com/lennayia/pro-app`
+2. **Clone and setup:**
+   ```bash
+   git clone https://github.com/lennayia/pro-app.git
+   cd pro-app
+   # Follow Phase 1 setup
+   ```
+3. **Create Supabase project:** https://supabase.com/dashboard
+4. **Start migration!** ğŸš€
+
+---
+
+## ğŸ’¬ QUESTIONS? CONTACT
+
+- **Claude Code Session:** Review this plan
+- **Phase 1 Help:** Follow tasks step-by-step
+- **Stuck?** Open new Claude Code session with specific phase
+
+---
+
+**End of Migration Plan**
+**Version:** 1.0
+**Last Updated:** 12. listopadu 2025
+
+---
+
+**Good luck! Jsi ready? ğŸ’ªğŸš€**
-- 
2.43.0


From 9755305c98f3149423c719588d12e30478988389 Mon Sep 17 00:00:00 2001
From: Claude <noreply@anthropic.com>
Date: Wed, 12 Nov 2025 21:30:23 +0000
Subject: [PATCH 2/2] docs: Add ContentPro module to migration plan

- Added ContentPro as 5th module (social media management)
- Complete database schema (accounts, posts, analytics, media)
- Edge Functions: post scheduler + AI content generator
- Social APIs: Facebook, Instagram, LinkedIn, X, YouTube
- Updated timeline: 8-11 weeks (was 6-8)
- Updated subscription tiers (Business plan includes all 5)
---
 docs/MONOREPO_MIGRATION_PLAN.md | 335 ++++++++++++++++++++++++++++++--
 1 file changed, 321 insertions(+), 14 deletions(-)

diff --git a/docs/MONOREPO_MIGRATION_PLAN.md b/docs/MONOREPO_MIGRATION_PLAN.md
index 2084e54..e53c227 100644
--- a/docs/MONOREPO_MIGRATION_PLAN.md
+++ b/docs/MONOREPO_MIGRATION_PLAN.md
@@ -9,13 +9,13 @@
 ## ğŸ“‹ EXECUTIVE SUMMARY
 
 ### Current State
-- **4 separate projects:** CoachPro, PaymentsPro, DigiPro, LifePro
+- **5 separate projects:** CoachPro, PaymentsPro, DigiPro, LifePro, ContentPro
 - **3 tech stacks:** React+Vite, React+Vite+Express, Next.js
 - **3 databases:** Supabase (CoachPro), SQLite (PaymentsPro), SQLite (DigiPro)
 - **Duplication:** ~85% code duplication in UI, auth, utils
 
 ### Target State
-- **1 monorepo:** `pro-app` with 5 apps (ProApp + 4 modules)
+- **1 monorepo:** `pro-app` with 6 apps (ProApp + 5 modules)
 - **1 tech stack:** React + Vite + Supabase (unified)
 - **1 database:** Shared Supabase PostgreSQL
 - **Shared packages:** 73-85% code reduction via `@pro/*` packages
@@ -78,12 +78,22 @@ pro-app/                              # Turborepo monorepo
 â”‚   â”‚   â”‚   â””â”€â”€ App.jsx
 â”‚   â”‚   â””â”€â”€ package.json
 â”‚   â”‚
-â”‚   â””â”€â”€ lifepro/                      # MODULE 4 (change from Next.js)
-â”‚       â”œâ”€â”€ src/                      # React + Vite (NOT Next.js!)
+â”‚   â”œâ”€â”€ lifepro/                      # MODULE 4 (change from Next.js)
+â”‚   â”‚   â”œâ”€â”€ src/                      # React + Vite (NOT Next.js!)
+â”‚   â”‚   â”‚   â”œâ”€â”€ pages/
+â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Questionnaire/
+â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Results/
+â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AIAnalysis/
+â”‚   â”‚   â”‚   â””â”€â”€ App.jsx
+â”‚   â”‚   â””â”€â”€ package.json
+â”‚   â”‚
+â”‚   â””â”€â”€ contentpro/                   # MODULE 5 (NEW! - Social Media Management)
+â”‚       â”œâ”€â”€ src/                      # React + Vite
 â”‚       â”‚   â”œâ”€â”€ pages/
-â”‚       â”‚   â”‚   â”œâ”€â”€ Questionnaire/
-â”‚       â”‚   â”‚   â”œâ”€â”€ Results/
-â”‚       â”‚   â”‚   â””â”€â”€ AIAnalysis/
+â”‚       â”‚   â”‚   â”œâ”€â”€ ContentCalendar/  # Visual calendar for scheduled posts
+â”‚       â”‚   â”‚   â”œâ”€â”€ PostComposer/     # Multi-platform post editor
+â”‚       â”‚   â”‚   â”œâ”€â”€ Analytics/        # Social media insights
+â”‚       â”‚   â”‚   â””â”€â”€ MediaLibrary/     # Asset management
 â”‚       â”‚   â””â”€â”€ App.jsx
 â”‚       â””â”€â”€ package.json
 â”‚
@@ -139,8 +149,13 @@ pro-app/                              # Turborepo monorepo
 â”‚   â”‚   â”‚   â””â”€â”€ stripe.js            # From PaymentsPro + ProApp subscriptions
 â”‚   â”‚   â”œâ”€â”€ courses/
 â”‚   â”‚   â”‚   â””â”€â”€ kajabi.js
+â”‚   â”‚   â”œâ”€â”€ social/                  # â­ NEW - For ContentPro
+â”‚   â”‚   â”‚   â”œâ”€â”€ meta.js              # Facebook + Instagram Graph API
+â”‚   â”‚   â”‚   â”œâ”€â”€ linkedin.js          # LinkedIn API
+â”‚   â”‚   â”‚   â”œâ”€â”€ twitter.js           # X (Twitter) API
+â”‚   â”‚   â”‚   â””â”€â”€ youtube.js           # YouTube Data API
 â”‚   â”‚   â””â”€â”€ ai/
-â”‚   â”‚       â””â”€â”€ claude.js            # For LifePro AI analysis
+â”‚   â”‚       â””â”€â”€ claude.js            # For LifePro AI analysis + ContentPro text generation
 â”‚   â”‚
 â”‚   â”œâ”€â”€ @pro/notifications/           # Toast + Email
 â”‚   â”‚   â”œâ”€â”€ NotificationContext.jsx  # From CoachPro (toast)
@@ -159,11 +174,14 @@ pro-app/                              # Turborepo monorepo
 â”‚   â”‚   â”œâ”€â”€ 002_coachpro.sql        # CoachPro tables (existing)
 â”‚   â”‚   â”œâ”€â”€ 003_paymentspro.sql     # PaymentsPro (migrate from SQLite)
 â”‚   â”‚   â”œâ”€â”€ 004_digipro.sql         # DigiPro (migrate from SQLite)
-â”‚   â”‚   â””â”€â”€ 005_lifepro.sql         # LifePro tables
+â”‚   â”‚   â”œâ”€â”€ 005_lifepro.sql         # LifePro tables
+â”‚   â”‚   â””â”€â”€ 006_contentpro.sql      # ContentPro tables (NEW!)
 â”‚   â”œâ”€â”€ functions/                   # Edge Functions (serverless!)
 â”‚   â”‚   â”œâ”€â”€ claude-analysis/        # LifePro AI (Claude API)
 â”‚   â”‚   â”œâ”€â”€ pdf-export/             # LifePro PDF generation
-â”‚   â”‚   â””â”€â”€ stripe-webhook/         # ProApp subscription webhooks
+â”‚   â”‚   â”œâ”€â”€ stripe-webhook/         # ProApp subscription webhooks
+â”‚   â”‚   â”œâ”€â”€ social-post-scheduler/  # ContentPro scheduling (NEW!)
+â”‚   â”‚   â””â”€â”€ ai-content-generator/   # ContentPro AI text generation (NEW!)
 â”‚   â””â”€â”€ seed/
 â”‚       â”œâ”€â”€ test_users.sql
 â”‚       â””â”€â”€ demo_data.sql
@@ -233,7 +251,7 @@ CREATE TABLE subscriptions (
 -- Module Access Control
 CREATE TABLE module_access (
   user_id uuid REFERENCES users(id) ON DELETE CASCADE,
-  module_name text NOT NULL, -- 'coachpro', 'paymentspro', 'digipro', 'lifepro'
+  module_name text NOT NULL, -- 'coachpro', 'paymentspro', 'digipro', 'lifepro', 'contentpro'
   has_access boolean DEFAULT false,
   granted_at timestamptz DEFAULT now(),
   PRIMARY KEY (user_id, module_name)
@@ -535,7 +553,27 @@ export default function Dashboard() {
       icon: 'ğŸ’°',
       url: 'https://paymentspro.vercel.app'
     },
-    // ... etc
+    {
+      name: 'digipro',
+      title: 'DigiPro',
+      description: 'Digital products & funnels',
+      icon: 'ğŸ“¦',
+      url: 'https://digipro.vercel.app'
+    },
+    {
+      name: 'lifepro',
+      title: 'LifePro',
+      description: 'Life purpose discovery',
+      icon: 'ğŸ¯',
+      url: 'https://lifepro.vercel.app'
+    },
+    {
+      name: 'contentpro',
+      title: 'ContentPro',
+      description: 'Social media management',
+      icon: 'ğŸ“±',
+      url: 'https://contentpro.vercel.app'
+    }
   ];
 
   return (
@@ -1109,7 +1147,8 @@ vercel --prod
 | **Phase 2** | Build ProApp (auth hub) | 5-7 days | Week 2 |
 | **Phase 3** | Migrate PaymentsPro + DigiPro | 10-14 days | Weeks 3-4 |
 | **Phase 4** | Integrate CoachPro + Build LifePro | 10-14 days | Weeks 5-6 |
-| **TOTAL** | **Complete migration** | **30-42 days** | **6-8 weeks** |
+| **Phase 5** | Build ContentPro (social media) | 10-14 days | Weeks 7-9 |
+| **TOTAL** | **Complete migration** | **40-56 days** | **8-11 weeks** |
 
 ---
 
@@ -1227,8 +1266,276 @@ During migration, create these docs:
 
 ---
 
+---
+
+## ğŸ“± CONTENTPRO MODULE - DETAILED SPEC
+
+### **Overview**
+ContentPro (Social Media Management) - Plan, create, schedule, and analyze content across multiple social platforms.
+
+### **Core Features**
+
+**1. Content Calendar** ğŸ“…
+- Visual monthly/weekly/daily view
+- Drag-and-drop post scheduling
+- Multi-platform post previews
+- Color-coded by platform (FB=blue, IG=pink, X=black, LinkedIn=blue)
+- Timezone support (Czech = Europe/Prague)
+
+**2. Post Composer** âœï¸
+- Multi-platform editor (single compose â†’ post to all)
+- Character limits per platform (X=280, LinkedIn=3000)
+- Image/video upload with preview
+- Hashtag suggestions
+- AI text generation (Claude API): "PÅ™epiÅ¡ to profesionÃ¡lnÄ›", "ZkraÅ¥ na tweet"
+- Emoji picker
+- Link shortening
+
+**3. Media Library** ğŸ–¼ï¸
+- Upload images/videos
+- Organize by folders/tags
+- Automatic WebP compression (reuse from CoachPro!)
+- Quick insert into posts
+
+**4. Analytics** ğŸ“Š
+- Post performance (likes, shares, comments, reach)
+- Best posting times
+- Engagement rate trends
+- Platform comparison
+- Export reports (PDF)
+
+**5. Social Accounts** ğŸ”—
+- Connect multiple accounts per platform
+- OAuth for FB, IG, LinkedIn, X
+- Account switching
+- Profile info display
+
+### **Database Schema**
+
+```sql
+-- supabase/migrations/006_contentpro.sql
+
+-- Social Accounts
+CREATE TABLE contentpro_accounts (
+  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
+  user_id uuid REFERENCES users(id) ON DELETE CASCADE,
+  platform text NOT NULL, -- 'facebook', 'instagram', 'linkedin', 'twitter', 'youtube'
+  account_name text NOT NULL,
+  account_id text NOT NULL, -- Platform's account ID
+  access_token text NOT NULL, -- Encrypted!
+  refresh_token text,
+  token_expires_at timestamptz,
+  profile_picture_url text,
+  is_active boolean DEFAULT true,
+  created_at timestamptz DEFAULT now(),
+  updated_at timestamptz DEFAULT now()
+);
+
+-- Posts
+CREATE TABLE contentpro_posts (
+  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
+  user_id uuid REFERENCES users(id) ON DELETE CASCADE,
+  content text NOT NULL,
+  scheduled_at timestamptz NOT NULL,
+  status text NOT NULL, -- 'draft', 'scheduled', 'published', 'failed'
+  platforms jsonb NOT NULL, -- ['facebook', 'instagram', 'linkedin']
+  media_urls jsonb, -- Array of image/video URLs
+  hashtags text[],
+  link_url text,
+  published_at timestamptz,
+  error_message text,
+  created_at timestamptz DEFAULT now(),
+  updated_at timestamptz DEFAULT now()
+);
+
+-- Post Analytics
+CREATE TABLE contentpro_analytics (
+  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
+  post_id uuid REFERENCES contentpro_posts(id) ON DELETE CASCADE,
+  platform text NOT NULL,
+  platform_post_id text, -- ID from platform API
+  likes int DEFAULT 0,
+  comments int DEFAULT 0,
+  shares int DEFAULT 0,
+  reach int DEFAULT 0,
+  engagement_rate numeric,
+  fetched_at timestamptz DEFAULT now()
+);
+
+-- Media Library
+CREATE TABLE contentpro_media (
+  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
+  user_id uuid REFERENCES users(id) ON DELETE CASCADE,
+  file_name text NOT NULL,
+  file_url text NOT NULL,
+  file_type text NOT NULL, -- 'image', 'video'
+  file_size bigint,
+  width int,
+  height int,
+  folder text,
+  tags text[],
+  created_at timestamptz DEFAULT now()
+);
+
+-- RLS Policies
+ALTER TABLE contentpro_accounts ENABLE ROW LEVEL SECURITY;
+ALTER TABLE contentpro_posts ENABLE ROW LEVEL SECURITY;
+ALTER TABLE contentpro_analytics ENABLE ROW LEVEL SECURITY;
+ALTER TABLE contentpro_media ENABLE ROW LEVEL SECURITY;
+
+-- Users can view/edit own data + check module access
+CREATE POLICY "Users with ContentPro access - accounts" ON contentpro_accounts
+  FOR ALL USING (
+    user_id = auth.uid() AND
+    EXISTS (
+      SELECT 1 FROM module_access
+      WHERE user_id = auth.uid()
+      AND module_name = 'contentpro'
+      AND has_access = true
+    )
+  );
+
+CREATE POLICY "Users with ContentPro access - posts" ON contentpro_posts
+  FOR ALL USING (
+    user_id = auth.uid() AND
+    EXISTS (
+      SELECT 1 FROM module_access
+      WHERE user_id = auth.uid()
+      AND module_name = 'contentpro'
+      AND has_access = true
+    )
+  );
+
+-- Same for analytics and media
+```
+
+### **Edge Functions**
+
+**1. social-post-scheduler** (Cron job)
+```typescript
+// Runs every 5 minutes
+// Checks for posts scheduled_at <= NOW and status = 'scheduled'
+// Publishes to platforms via APIs
+
+import { serve } from 'https://deno.land/std@0.168.0/http/server.ts';
+
+serve(async (req) => {
+  // 1. Fetch posts to publish
+  const { data: posts } = await supabase
+    .from('contentpro_posts')
+    .select('*, account:contentpro_accounts(*)')
+    .lte('scheduled_at', new Date().toISOString())
+    .eq('status', 'scheduled');
+
+  for (const post of posts) {
+    for (const platform of post.platforms) {
+      try {
+        // 2. Publish to platform
+        if (platform === 'facebook') {
+          await publishToFacebook(post, post.account);
+        } else if (platform === 'instagram') {
+          await publishToInstagram(post, post.account);
+        }
+        // ... etc
+
+        // 3. Update status
+        await supabase
+          .from('contentpro_posts')
+          .update({ status: 'published', published_at: new Date() })
+          .eq('id', post.id);
+      } catch (error) {
+        // Mark as failed
+        await supabase
+          .from('contentpro_posts')
+          .update({ status: 'failed', error_message: error.message })
+          .eq('id', post.id);
+      }
+    }
+  }
+
+  return new Response('OK');
+});
+```
+
+**2. ai-content-generator** (On-demand)
+```typescript
+// Claude API for content suggestions
+
+serve(async (req) => {
+  const { prompt, platform, tone } = await req.json();
+
+  const anthropic = new Anthropic({
+    apiKey: Deno.env.get('ANTHROPIC_API_KEY')
+  });
+
+  const systemPrompt = `You are a social media expert. Generate content for ${platform}.
+Tone: ${tone} (professional/casual/funny)
+Character limit: ${platform === 'twitter' ? 280 : 3000}
+Include 3-5 relevant hashtags.`;
+
+  const message = await anthropic.messages.create({
+    model: 'claude-3-5-sonnet-20241022',
+    max_tokens: 500,
+    messages: [{ role: 'user', content: prompt }],
+    system: systemPrompt
+  });
+
+  return new Response(JSON.stringify({
+    content: message.content[0].text
+  }));
+});
+```
+
+### **Social Platform APIs**
+
+**Meta (Facebook + Instagram):**
+- OAuth: Facebook Login
+- API: Graph API v18.0
+- Publish: `POST /{page-id}/feed` (FB), `POST /{ig-user-id}/media` (IG)
+
+**LinkedIn:**
+- OAuth: OAuth 2.0
+- API: LinkedIn Marketing API
+- Publish: `POST /v2/ugcPosts`
+
+**X (Twitter):**
+- OAuth: OAuth 2.0
+- API: Twitter API v2
+- Publish: `POST /2/tweets`
+
+**YouTube:**
+- OAuth: Google OAuth
+- API: YouTube Data API v3
+- Publish: `POST /youtube/v3/videos`
+
+### **UI Components (Reuse from @pro/ui)**
+
+- `<ContentCalendar />` - Full-calendar view (react-big-calendar?)
+- `<PostComposer />` - Multi-platform editor
+- `<MediaLibrary />` - Grid with upload (reuse PhotoUpload!)
+- `<PlatformAccountCard />` - Connect/disconnect accounts
+- `<AnalyticsChart />` - Chart.js or Recharts
+
+### **Implementation Timeline**
+
+**Phase 5: ContentPro** (Weeks 7-9)
+- **Week 7:** Database schema, account connection (OAuth)
+- **Week 8:** Post composer, media library, calendar UI
+- **Week 9:** Scheduler Edge Function, analytics, testing
+
+### **Subscription Tiers (Updated)**
+
+| Plan | Price | Modules Included |
+|------|-------|------------------|
+| **Free** | $0 | CoachPro only |
+| **Basic** | $9/mo | CoachPro, PaymentsPro |
+| **Premium** | $29/mo | CoachPro, PaymentsPro, DigiPro, LifePro |
+| **Business** | $49/mo | **ALL 5 modules** (+ ContentPro!) |
+
+---
+
 **End of Migration Plan**
-**Version:** 1.0
+**Version:** 1.1 (Updated with ContentPro)
 **Last Updated:** 12. listopadu 2025
 
 ---
-- 
2.43.0
